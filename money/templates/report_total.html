{% extends "base.html" %}


{% load i18n %}

{% block content %}
<h1>{% trans "Total report" %}</h1>

<selector-year title="{% trans 'Select a year' %}" year_start="{{ year_start }}" year_end="{{ year_end }}" year="{{ year }}" url="{% url 'report_total' %}"></selector-year>
<p></p>
<p>Last year balance ({{last_year|date:"Y-m-d"}}) is {{ str_last_year_balance }}</p>

{{table_report_total|safe}}
<p>
</p>


<ajax-button id="ajax_button_income" url="{% url 'ajax_report_total_income' year %}" buttontext="{% trans 'Get income report' %}" csrf_token="{{csrf_token}}"></ajax-button>


<h1>{% trans 'Show gains by product type' %}</h1>

<form class="normal" method="post" id="form_gains_by_product_type">{% csrf_token %}
  <button id="button_gains_by_product_type" type="submit">{% trans "Gains by product type report" %}</button>
  </form>
  
  <div id="gains_by_product_type"></div>
  <script>
  $(document).ready(function() {
    $("#button_gains_by_product_type").click(function(e) {
      e.preventDefault();
      $.ajax({
        type: "POST",
        url: "{% url 'ajax_report_gains_by_product_type' year %}",
        data: {
              csrfmiddlewaretoken: "{{csrf_token}}",
        },
        success: function(result) {
          $("#gains_by_product_type").html(result);    
          $("#form_gains_by_product_type").css("display", "none");
  
        },
        error: function(result) {
          $("#gains_by_product_type").html('<p>{% trans "Somethng is wrong" %}</p>');          
        }
      });
    });
  });
  </script>
{% endblock %}

